import React, {Component} from 'react';
import {toast, ToastContainer} from 'react-toastify';
import 'react-toastify/dist/ReactToastify.css';
import "./contactUsStyle.css"
import {Element} from 'react-scroll'
import {withTranslation} from "react-i18next";
import instagram from "../../../Img/instagram.png"

const apiUrl = process.env.REACT_APP_API_URL;

class ContactUs extends Component {
    state = {
        title: '',
        er: false,
        all_ok: false,
        empty_err: false,
        nomail: false,
        en: ''
    }

    handleKeyDown = (event) => {
        if (event.key === 'Enter') {
            this.emaailSend();
        }
    };

    handleChange = (event) => {
        const {name, value} = event.target;
        this.setState({
            [name]: value
        });
        this.setState({
            er: false
        });
        this.setState({
            empty_err: false
        });
        this.setState({
            all_ok: false
        });
        this.setState({
            nomail: false
        });
    };

    emaailSend = () => {
        const regex = /^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;
        const {name, email, message} = this.state;
        const messages = {
            name,
            email,
            message
        }
        if (!name || !email || !message) {
            // Do this instead
            setTimeout(() => {
                this.setState({
                    empty_err: false
                });
            }, 1000);
            this.setState({
                empty_err: true
            });
            return;
        }
        if (regex.test(email) === false) {
            setTimeout(() => {
                this.setState({
                    nomail: false
                });
            }, 1000);
            this.setState({
                nomail: true
            });
            return;
        }
        const body = JSON.stringify(messages);
        fetch(`${apiUrl}/api/v1/sent`, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: body
        })
            .then((res) => res.json())
            .then(response => {
                if (response.message === "success") {
                    this.setState({
                        all_ok: true,
                        name: '',
                        email: '',
                        message: ''
                    });
                } else {
                    this.setState({
                        en: response.message,
                        er: true

                    });
                }
            })
            .catch((error) => {

            })
    };

    componentDidUpdate(prevProps, prevState, snapshot) {
        if (this.state.er) {
            toast.error(this.state.en, {
                position: "top-center",
                autoClose: 5000,
                hideProgressBar: true,
                closeOnClick: true,
                pauseOnHover: true,
                draggable: true,
                progress: undefined,
            });

        }
        if (this.state.all_ok) {
            toast.success("Сообшение отпровлено", {
                position: "top-center",
                autoClose: 5000,
                hideProgressBar: true,
                closeOnClick: true,
                pauseOnHover: true,
                draggable: true,
                progress: undefined,
            });
        }
        if (this.state.nomail) {
            toast.error("Неверный адрес электронной почты!\"", {
                position: "top-center",
                autoClose: 5000,
                hideProgressBar: true,
                closeOnClick: true,
                pauseOnHover: true,
                draggable: true,
                progress: undefined,
            });
        }
        if (this.state.empty_err) {
            toast.error("Пожалуйста, заполните все поля", {
                position: "top-center",
                autoClose: 5000,
                hideProgressBar: true,
                closeOnClick: true,
                pauseOnHover: true,
                draggable: true,
                progress: undefined,
            });

        }
    }

    render() {
        const {t} = this.props;
        return (
            <Element className="contact" name="contact">
                <div className="container">
                    <div className="footer_contact">
                        <div className="footer_headText">
                            <div className="footer_title">
                                <p className="main_title">
                                    {t("Contact")}
                                </p>
                            </div>
                        </div>
                        <div className="footerBlocks">
                            <div className="contactUs">
                                <div className="footer_subTitle">
                                    <p className="footer_subTitle_text">
                                        {t("FormText")}
                                    </p>
                                </div>
                                <form>
                                    <input
                                        type="text"
                                        id="fname"
                                        name="name"
                                        placeholder={t("Name")}
                                        onKeyDown={this.handleKeyDown}
                                        onChange={this.handleChange}
                                        value={this.state.name}
                                    />
                                    <input
                                        type="email"
                                        id="lname"
                                        name="email"
                                        placeholder={t("Email")}
                                        onKeyDown={this.handleKeyDown}
                                        onChange={this.handleChange}
                                        value={this.state.email}
                                    />
                                    <textarea
                                        id="subject"
                                        name="message"
                                        placeholder={t("Message")}
                                        onKeyDown={this.handleKeyDown}
                                        onChange={this.handleChange}
                                        value={this.state.message}
                                    >
                                </textarea>
                                    <button
                                        type="button"
                                        className="contactUs_button"
                                        onClick={this.emaailSend}
                                    >
                                        {t("Send")}
                                        <span className="lineButton contact_lineButton1"></span>
                                        <span className="lineButton2 contact_lineButton2"></span>
                                    </button>
                                </form>
                            </div>
                            <div className="moreUs">
                                <div className="footer_subTitle">
                                    <p className="footer_subTitle_text">
                                        {t("Find")}
                                    </p>
                                </div>
                                <div className="logo">
                                    <svg xmlns="http://www.w3.org/2000/svg" id="Слой_1" data-name="Слой 1"
                                         viewBox="0 0 359.49 239.53" fill='#1e1e1e'>
                                        <defs>
                                            {/*<style>.cls-1{fill:#fff;}</style>*/}
                                        </defs>
                                        <path className="cls-1"
                                              d="M170.57,155.48a17,17,0,0,0-.47-4.59,3.88,3.88,0,0,0-1.58-2.31,6,6,0,0,0-3.21-.7h-7v1.75h.58c1.64,0,2.73.48,3.28,1.44a9.22,9.22,0,0,1,.82,4.41v31h27.79v-2.63H170.57Z"/>
                                        <path className="cls-1"
                                              d="M203.05,183.31a9.17,9.17,0,0,1-.82-4.42v-31h-7.61v31a17.66,17.66,0,0,0,.47,4.65,3.75,3.75,0,0,0,1.58,2.28,6.24,6.24,0,0,0,3.21.67h7v-1.75h-.59C204.68,184.74,203.59,184.26,203.05,183.31Z"/>
                                        <path className="cls-1"
                                              d="M241,174.62l-20.12-23.41a8.47,8.47,0,0,0-3.48-2.66,14.46,14.46,0,0,0-5.36-.85H208v1.76h.29c1.91,0,3.27.47,4.07,1.4a5.77,5.77,0,0,1,1.2,3.86v31.6h2.92v-29l24.81,29.13h2.69V147.7H241Z"/>
                                        <path className="cls-1"
                                              d="M319.15,183.86H261.43V167.77h15.22v-2.63H261.43V150.51h9.42a7.81,7.81,0,0,1,5.47,1.7c1.23,1.13,1.85,2.91,1.85,5.32h1.75v-5q0-4.68-5-4.68h-25.8v1.75h.58c1.64,0,2.73.48,3.28,1.44a9.22,9.22,0,0,1,.82,4.41v31h69.36C324.67,186.49,321.38,183.86,319.15,183.86Z"/>
                                        <polygon className="cls-1"
                                                 points="131.98 99.53 133.02 106.05 136.15 113.01 143.63 121.62 155.63 128.84 164.06 129.97 172.93 126.4 179.19 119.36 181.28 107.7 181.28 100.14 176.15 100.92 167.37 95.62 158.5 97.53 148.76 95.97 137.8 98.57 131.98 99.53"/>
                                        <path className="cls-1"
                                              d="M131.36,93.78s4.83,3.61,8.16,2.68,2.87-6.46,3.4-8.32,4.05-4.2,5.92-2.34,1.59,5.73,4.12,6.13,3.73,1.33,5.2-1.73,3.33-6.13,3.33-4-1.87,3.07,0,6.13,2.26-.93,5.06-1.73,2.93.66,5.46,3.73,3.86,6.12,6.25,4.39,3.47-2.66,3.47-2.66-.67,3.46-.67,4.39-3.37.71-5.1,2.44-3.11,11.85-5.55,11.45-4.22-3.19-4.13-7.72.44-4.53-1.78-5.33-6-1.77-6.83,1-3-3-4.88-2.93-2.84,4.26-4.35,6.39-4.09-4.26-5.95-4.53-2.22,6.93-3.73,7.2-5.41-8.44-6-8.53Z"/>
                                        <path className="cls-1"
                                              d="M129.49,65.86s.38,7.33,4.82,12.72a.19.19,0,0,0,.34-.18c-1.1-2.66-3.18-8.23-1.36-8.53,2.4-.4,1.13-2.15,2.26-5s-.07-5.33,2.86-5.06,3.26,1.06,4.39,2.93,1.07,2.93,1.94,4.79.59-1.4.26-3.46.47-3.86,2.27-3.6,2.26,1.53,3.46,2.87.26,3.32-.2,6.79S149.15,82,150.67,84c.33.42.46-12.57,1.66-15.1s1.42-4.57,2.29-3.3.4,1.8,1.2,4.13,2,1.06,1.59-.8-.61-8.34,1.31-8.62c2.81-.41,3.4,3.22,3.07,6.55s-2.47,6.5-.41,8.3,2.93-1.93,2.86-4.66.68-7.8,1.4-8.86a5.44,5.44,0,0,1,2.53-1.73s-2.66-.27-3.13-1.4-2.43-2.52-3.23-1.72-2.29,3-5.29,2.92-6.7-.11-8-1.44-2.26-2.26-3.32-1.73-4,2.84-4.49,2.24-2.46-2.93-4-2.3-1.17,1.57-1.7,1.9-.77-.18-1.5.71-1.66,3-2.3,3.45A3.43,3.43,0,0,0,129.49,65.86Z"/>
                                        <path className="cls-1"
                                              d="M147.83,61.72a1.38,1.38,0,0,0-2,1.51c0,2.22,1.38,4.22.93,6.71a23.89,23.89,0,0,0-.18,9,14.12,14.12,0,0,0,3.6,7.41A16,16,0,0,1,148.41,78c.4-4.44,1.2-7.55,1.6-10.83S148.63,61.68,147.83,61.72Z"/>
                                        <path className="cls-1"
                                              d="M160.06,62.19a1.09,1.09,0,0,0-1.65-.19,1,1,0,0,0-.28.61,20,20,0,0,0,.27,5.64,17.62,17.62,0,0,1,.17,6.57c-.35,1,.89.09.94.89s1.68,3,2,6.3c0,0,.22,1.42.27-.71s-2-5.55-2-7,.71-5.37.89-7.19C160.76,65.66,160.87,63.34,160.06,62.19Z"/>
                                        <path className="cls-1"
                                              d="M168.9,58.76a2.69,2.69,0,0,0-1.68,1.05c-.47.65-.66,1.62.75,2.69a7,7,0,0,0,6,1.25c1.39-.7,4.86-1.73,2.82-3.13,0,0-4.76-1.43-5.79-1.85A4,4,0,0,0,168.9,58.76Z"/>
                                        <path className="cls-1"
                                              d="M179.44,67.47c-.34-.06-.63-.21,0,1.92s1.25,5.6-.31,7.5-2.23,2.36-1.14,4.9-5.17,9-5.06,11.42c.12,2.6,2.84,4.3,4.16,4.39s5.3-3.19,5.63-4.35,0-1.89,1.14-6.1,2.55-10.63,1.37-13.87-1.81-2.2-3.47-4S179.72,67.52,179.44,67.47Z"/>
                                        <path className="cls-1"
                                              d="M130.13,68.6a11,11,0,0,0,0,3.81c.4,1.83,1.93,5.84,3.76,7.5a6.51,6.51,0,0,0,2,.27c1.2,0,1.1,2.66,1.16,4.3s1.1,1,2.17,1.39,2.56,2.3,2.26,4.9-.69,4.15-3.28,4-5.74-1.39-7-3.12a13.18,13.18,0,0,0-.53-2.33c-.5-1.77-1.51-4.77-.48-8.13s1-.91-.15-7.45A35.13,35.13,0,0,1,130.13,68.6Z"/>
                                        <path className="cls-1"
                                              d="M130.84,75a10.14,10.14,0,0,1,1.1-5.84c1.57-2.78,2.3-5.56,3.17-3.3s0,4.52,1.74,6.09,0,4.52.52,8.87,1.85,5,1.85,5,.58,4-3.76.18-2.69-3.94-3.39-7.25S130.84,75,130.84,75Z"/>
                                        <path className="cls-1"
                                              d="M181.41,62.1s-1.76,6.56-.91,10.74,2,2.8,1.5,6.84-2.35,4.11-2.28,6.07,3.71,2.8,5.28-1.44S181.41,62.1,181.41,62.1Z"/>
                                        <path className="cls-1"
                                              d="M181,63.77s-.85,5.15-.53,7.43,1.11,4.83-1,6.33-3.53,1.31-4.31,3.46-.26,6.91-1.76,6.65-.59-5.94,1.5-9.13,3.26-5.28,2.74-8.09-.52-7.63.06-8.74S181,63.77,181,63.77Z"/>
                                        <path className="cls-1"
                                              d="M182.68,68.86a11.68,11.68,0,0,0-.74-3,7.31,7.31,0,0,0-.72-1.23,3.86,3.86,0,0,0-.83-.87,7.72,7.72,0,0,0-2.58-1c-1-.26-2.22-.45-3.51-.87a10.51,10.51,0,0,1-2-.89c-.17-.09-.34-.2-.51-.31l-.25-.18c-.06,0-.24-.19-.12-.08a1.33,1.33,0,0,0,.47.26,2.82,2.82,0,0,0,.29.06c.06,0-.13,0-.32.12l-.72.27a8.47,8.47,0,0,1-2.25.58,5.47,5.47,0,0,1-3.21-.66,6.85,6.85,0,0,1-2-1.83l-.59-.8-.26-.38-.12-.17a.91.91,0,0,0,.13.16,1.34,1.34,0,0,0,1.57.27c.2-.06.59-.55.18-.09-.24.26-.49.52-.76.77a9,9,0,0,1-1.88,1.38c-.71.39-1.65-1.13-3.28-.74-1.24.19-2.26,1.57-3,1.47-2.58.29-3.33,0-5.54-1.31l-.43-.14c-.22-.08-.44-.15-.65-.25a4.33,4.33,0,0,1-1-.7c-.54-.49-.84-.87-1.14-1.08a1.58,1.58,0,0,0-.46-.25,2.6,2.6,0,0,0-.46-.12,3.48,3.48,0,0,0-1.4.47c-.51.25-1,.52-1.63.76a5.57,5.57,0,0,1-2.13.49,3.71,3.71,0,0,1-2.35-.92,5.32,5.32,0,0,1-.8-.85c-.19-.25,0,0-.08-.08l-.13-.07a1.09,1.09,0,0,0-.68-.11s0,0-.06,0,0,0,0,.06a.09.09,0,0,1,0,.06c-.05.1-.12.24-.17.32A14.49,14.49,0,0,1,135.2,59L134,60.3A17.3,17.3,0,0,1,131.5,63l-.2.16-.11.08a.8.8,0,0,0,.18-.17c.15-.21.08-.15.08-.11a4,4,0,0,0-.11.62c-.07.51-.1,1.07-.14,1.64L131,68.74a12.75,12.75,0,0,0,0,3.15c.14,1,.44,2.16.64,3.37a15.44,15.44,0,0,1,.2,3.73,18.12,18.12,0,0,1-.72,3.59,11.38,11.38,0,0,0-.54,3.14,9.14,9.14,0,0,0,.14,1.56c.05.26.11.52.17.79s.15.62.2.91c.2,1.19.33,2.33.48,3.47a59.11,59.11,0,0,0,3.11,13.29,32.26,32.26,0,0,0,3,6.05,25.64,25.64,0,0,0,4.25,5.06,47.88,47.88,0,0,0,5.44,3.92,60.15,60.15,0,0,0,5.8,3.3,32.59,32.59,0,0,0,5.87,2.31,11.7,11.7,0,0,0,5.29.38l.29-.06.33-.1.67-.19c.45-.15.88-.33,1.32-.49a17.21,17.21,0,0,0,2.51-1.4,19.48,19.48,0,0,0,4.25-4,20.24,20.24,0,0,0,2.94-5.21,27.45,27.45,0,0,0,1.47-6.12c.38-2.26.72-4.5,1-6.78s.63-4.68,1.21-7.07.95-4.27,1.41-6.71a32,32,0,0,1,.95-3.56c.33-1,.62-2.12.86-3.2a23.43,23.43,0,0,0,.72-6.4,6.76,6.76,0,0,0-.19-1.37c-.06-.23-.39-1-.58-1.56A20.83,20.83,0,0,1,182.68,68.86Zm3.15-.49a17.85,17.85,0,0,0,.73,3.1c.16.5.36.81.65,1.67a10,10,0,0,1,.37,2,30.77,30.77,0,0,1-.51,7.37c-.21,1.19-.46,2.36-.76,3.54a21.54,21.54,0,0,0-.63,3.18l-.39,3.43c-.13,1.17-.35,2.44-.54,3.52a66,66,0,0,0-.63,6.67c-.14,2.31-.32,4.66-.53,7a33,33,0,0,1-1.35,7.41,24.77,24.77,0,0,1-3.58,7,23.05,23.05,0,0,1-5.68,5.55,20,20,0,0,1-7.52,3.23,15.9,15.9,0,0,1-8.36-1,30.88,30.88,0,0,1-6.65-3.59,59.48,59.48,0,0,1-5.62-4.53c-.88-.79-1.73-1.61-2.59-2.42a35.28,35.28,0,0,1-2.52-2.64,38.68,38.68,0,0,1-6.89-12.52,76,76,0,0,1-3.07-13.69c-.17-1.14-.33-2.3-.53-3.38-.06-.29-.11-.51-.18-.78s-.15-.6-.22-.91a10.62,10.62,0,0,1-.23-1.88,13.28,13.28,0,0,1,.48-3.69,15.24,15.24,0,0,0,.53-3.21,13.66,13.66,0,0,0-.29-3.17c-.22-1.06-.57-2.17-.79-3.41a14.88,14.88,0,0,1-.18-3.76l.16-3.41c0-.59,0-1.18.1-1.82a6.68,6.68,0,0,1,.19-1.08,2.3,2.3,0,0,1,.43-.9,2.72,2.72,0,0,1,.34-.31l.07,0,.13-.11a16.31,16.31,0,0,0,2.15-2.38l1.12-1.3a11,11,0,0,0,.9-1.19l0,0,.18-.33a3,3,0,0,1,.48-.62,2.89,2.89,0,0,1,1.43-.78,3.81,3.81,0,0,1,2.66.47,4.11,4.11,0,0,1,.58.43,2.35,2.35,0,0,1,.47.58,2.78,2.78,0,0,0,.34.45,1.44,1.44,0,0,0,.77.46,3,3,0,0,0,1.24-.18c.5-.15,1-.35,1.57-.56l.85-.31a6.85,6.85,0,0,1,1-.36,2.45,2.45,0,0,1,.69-.07,3.86,3.86,0,0,1,.58,0,4.23,4.23,0,0,1,1.15.34,19.08,19.08,0,0,1,1.65,1,1.32,1.32,0,0,0,.46.17,1.09,1.09,0,0,0,.18,0l.41,0a66.71,66.71,0,0,0,6.75-.07,3.33,3.33,0,0,0,1.82-.67,8,8,0,0,0,.83-.76c.15-.15.29-.32.44-.49l.1-.14s.21-.24.33-.36a4.42,4.42,0,0,1,1-.74,4.07,4.07,0,0,1,4.76.84,3.72,3.72,0,0,1,.4.49l.13.18.23.34.43.6c.25.35.5.57.45.55s-.1,0,.11,0a5.1,5.1,0,0,0,1.13-.2l.94-.23a7.23,7.23,0,0,1,1.38-.19,3.61,3.61,0,0,1,1.15.13,3.41,3.41,0,0,1,1.24.64c.23.19.16.14.21.19l.09.09.21.18a5.43,5.43,0,0,0,1.08.68c.86.43,1.93.8,3.09,1.25a11.71,11.71,0,0,1,3.6,2,7.29,7.29,0,0,1,1.44,1.74,11.47,11.47,0,0,1,.89,1.83A16.59,16.59,0,0,1,185.83,68.37Z"/>
                                        <path className="cls-1"
                                              d="M40.61,154.73a9.17,9.17,0,0,0-.82-4.42c-.55-.95-1.64-1.43-3.27-1.43h-.59v-1.76h7a6.13,6.13,0,0,1,3.22.7,3.87,3.87,0,0,1,1.58,2.32,17.36,17.36,0,0,1,.47,4.59v28.38H68.4v2.63H40.61Z"/>
                                        <path className="cls-1"
                                              d="M98.48,184.42q-3-1.54-4.86-6l-1.35-3.28H76.71l-4.8,10.65h-3l17.26-38.62h2.63l13.11,31.25q2.22,5.43,6.08,5.85v1.46a11,11,0,0,1-2.8.29A14.17,14.17,0,0,1,98.48,184.42Zm-20.54-12H91.16l-6.43-15.27Z"/>
                                        <path className="cls-1"
                                              d="M111.81,154.73a9.31,9.31,0,0,0-.81-4.42c-.55-.95-1.64-1.43-3.28-1.43h-.59v-1.76h15.8a32.43,32.43,0,0,1,12.32,2q4.94,2.06,4.94,8.19a7.45,7.45,0,0,1-2.13,5.06,11.89,11.89,0,0,1-6,3.37q9.88,1,9.89,9.24,0,6.09-4.86,8.4a28.92,28.92,0,0,1-12.4,2.31H111.81Zm12,9.89a9.27,9.27,0,0,0,6-1.79Q132,161,132,157.07t-2.6-5.82a11.18,11.18,0,0,0-6.47-1.79,9.85,9.85,0,0,0-2.46.24l-1,.17v14.75Zm0,18.78c3.24,0,5.7-.7,7.4-2.11a7.29,7.29,0,0,0,2.54-6q0-8.07-9.94-8.07h-4.39v15.56a5,5,0,0,0,1.17.3,13.58,13.58,0,0,0,2.93.29Z"/>
                                    </svg>
                                </div>
                                <div className="address">
                                    <p>{t("Address")}</p>
                                    <p>{t("Open")}</p>
                                    <p>+79999697979</p>
                                    <p>Labline178@gmail.com</p>
                                </div>
                                <div className="smm">
                                    <nav className="footNav">
                                        <div className="footerNavItem">
                                            <a href="https://www.instagram.com/labline.pro/?utm_medium=copy_link"
                                               target='_blank'><img src={instagram} alt=""/></a>
                                        </div>
                                    </nav>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <ToastContainer
                    position="bottom-right"
                    autoClose={5000}
                    hideProgressBar
                    newestOnTop={false}
                    closeOnClick
                    rtl={false}
                    pauseOnFocusLoss
                    draggable
                    pauseOnHover
                />
            </Element>
        )
    }
}

export default withTranslation()(ContactUs);